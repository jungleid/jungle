{{ define "main" }}
  {{ $slug := .Params.slug }}
  {{ $roadmap := index site.Data.roadmaps $slug }}

  <h1>{{ $roadmap.title }}</h1>

  <div class="roadmap-flow">
    {{ range $node := $roadmap.nodes }}
      <div class="roadmap-node" id="{{ $node.id }}">
        <strong>{{ $node.title }}</strong>

        {{ if $node.content }}
          <div class="node-detail">
            {{ $node.content | markdownify }}
          </div>
        {{ end }}

        {{ if $node.next }}
          <div class="branch-wrapper">
            {{ range $nextId := $node.next }}
              {{ $nextNodes := where $roadmap.nodes "id" $nextId }}
              {{ $nextNode := index $nextNodes 0 }}

              <div class="roadmap-node" id="{{ $nextNode.id }}">
                <strong>{{ $nextNode.title }}</strong>

                {{ if $nextNode.content }}
                  <div class="node-detail">
                    {{ $nextNode.content | markdownify }}
                  </div>
                {{ end }}
              </div>
            {{ end }}
          </div>
        {{ end }}
      </div>
    {{ end }}
  </div>
{{ end }}
